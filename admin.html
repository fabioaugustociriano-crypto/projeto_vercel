<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Painel do Dono - Pedidos</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      margin:0; padding:0;
      display:flex; justify-content:center; align-items:center;
      min-height:100vh;
    }
    .card {
      background:#fff;
      padding:30px;
      border-radius:15px;
      box-shadow:0 6px 15px rgba(0,0,0,.15);
      max-width:800px;
      width:100%;
    }
    h1, h2 { margin-bottom:20px; color:#333; text-align:center; }

    input, select, textarea {
      width:100%;
      padding:12px;
      margin:8px 0;
      border:1px solid #ddd;
      border-radius:8px;
      font-size:15px;
    }
    button {
      padding:10px 15px;
      background:#4e73df;
      border:none;
      border-radius:8px;
      color:#fff;
      font-size:15px;
      font-weight:600;
      cursor:pointer;
      transition:0.3s;
    }
    button:hover { background:#2e59d9; }

    .pedido-card {
      background:#f9f9f9;
      padding:15px;
      border-radius:10px;
      margin-bottom:15px;
      box-shadow:0 2px 5px rgba(0,0,0,.1);
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .pedido-info { flex:1; }
    .pedido img { max-width:80px; border-radius:8px; margin-left:10px; }

    .actions button { margin-left:5px; }
  </style>
</head>
<body>
  <!-- Tela de login -->
  <div id="login" class="card" style="max-width:400px;">
    <h2>üîë Acesso do Dono</h2>
    <input type="password" id="senha" placeholder="Digite a senha">
    <button onclick="entrar()">Entrar</button>
  </div>

  <!-- Painel do dono -->
  <div id="painel" class="card" style="display:none;">
    <h1>üì¶ Painel do Dono</h1>

    <!-- Formul√°rio -->
    <h2>Criar Pedido</h2>
    <input type="text" id="nome" placeholder="Nome do cliente">
    <input type="text" id="cpf" maxlength="4" placeholder="√öltimos 4 d√≠gitos do CPF">
    <textarea id="desc" placeholder="Descri√ß√£o do pedido"></textarea>
    <input type="file" id="foto" accept="image/*">
    <select id="status">
      <option value="Criado">Criado</option>
      <option value="Em produ√ß√£o">Em produ√ß√£o</option>
      <option value="Saiu para entrega destinada a loja">Saiu para entrega destinada a loja</option>
      <option value="Saiu para instala√ß√£o">Saiu para instala√ß√£o</option>
      <option value="Pedido pronto para retirada na loja">Pedido pronto para retirada na loja</option>
    </select>
    <button onclick="salvarPedido()">Salvar Pedido</button>

    <!-- Lista de pedidos -->
    <h2>Meus Pedidos</h2>
    <div id="lista-pedidos"></div>
  </div>

  <script>
    const SENHA = "Batista2025";
    let editandoId = null;

    function entrar(){
      const senha = document.getElementById("senha").value;
      if(senha === SENHA){
        document.getElementById("login").style.display="none";
        document.getElementById("painel").style.display="block";
        carregarPedidos();
      } else {
        alert("Senha incorreta!");
      }
    }

    function salvarPedido(){
      let pedidos = JSON.parse(localStorage.getItem("pedidos")||"[]");
      const nome = document.getElementById("nome").value.trim();
      const cpf = document.getElementById("cpf").value.trim();
      const desc = document.getElementById("desc").value.trim();
      const status = document.getElementById("status").value;
      const fotoInput = document.getElementById("foto");

      if(!nome || !cpf || !desc){
        alert("Preencha todos os campos!");
        return;
      }

      if(editandoId !== null){
        // Editar
        pedidos[editandoId].nome = nome;
        pedidos[editandoId].cpf = cpf;
        pedidos[editandoId].desc = desc;
        pedidos[editandoId].status = status;

        if(fotoInput.files[0]){
          const reader = new FileReader();
          reader.onload = function(e){
            pedidos[editandoId].foto = e.target.result;
            localStorage.setItem("pedidos", JSON.stringify(pedidos));
            carregarPedidos();
            limparFormulario();
          }
          reader.readAsDataURL(fotoInput.files[0]);
        } else {
          localStorage.setItem("pedidos", JSON.stringify(pedidos));
          carregarPedidos();
          limparFormulario();
        }

        editandoId = null;
      } else {
        // Criar
        const novoPedido = {nome, cpf, desc, status, foto:""};
        if(fotoInput.files[0]){
          const reader = new FileReader();
          reader.onload = function(e){
            novoPedido.foto = e.target.result;
            pedidos.push(novoPedido);
            localStorage.setItem("pedidos", JSON.stringify(pedidos));
            carregarPedidos();
            limparFormulario();
          }
          reader.readAsDataURL(fotoInput.files[0]);
        } else {
          pedidos.push(novoPedido);
          localStorage.setItem("pedidos", JSON.stringify(pedidos));
          carregarPedidos();
          limparFormulario();
        }
      }
    }

    function carregarPedidos(){
      const pedidos = JSON.parse(localStorage.getItem("pedidos")||"[]");
      const lista = document.getElementById("lista-pedidos");
      lista.innerHTML = "";
      if(pedidos.length === 0){
        lista.innerHTML = "<p>Nenhum pedido criado ainda.</p>";
      }
      pedidos.forEach((p, i)=>{
        const div = document.createElement("div");
        div.className="pedido-card";
        div.innerHTML = `
          <div class="pedido-info">
            <strong>${p.nome}</strong> - CPF: ****${p.cpf}<br>
            ${p.desc}<br>
            <em>Status: ${p.status}</em>
          </div>
          ${p.foto ? `<img src="${p.foto}">` : ""}
          <div class="actions">
            <button onclick="editarPedido(${i})">‚úèÔ∏è</button>
            <button onclick="excluirPedido(${i})">üóëÔ∏è</button>
          </div>
        `;
        lista.appendChild(div);
      });
    }

    function editarPedido(id){
      const pedidos = JSON.parse(localStorage.getItem("pedidos")||"[]");
      const p = pedidos[id];
      document.getElementById("nome").value = p.nome;
      document.getElementById("cpf").value = p.cpf;
      document.getElementById("desc").value = p.desc;
      document.getElementById("status").value = p.status;
      editandoId = id;
    }

    function excluirPedido(id){
      if(confirm("Tem certeza que deseja excluir este pedido?")){
        let pedidos = JSON.parse(localStorage.getItem("pedidos")||"[]");
        pedidos.splice(id,1);
        localStorage.setItem("pedidos", JSON.stringify(pedidos));
        carregarPedidos();
      }
    }

    function limparFormulario(){
      document.getElementById("nome").value="";
      document.getElementById("cpf").value="";
      document.getElementById("desc").value="";
      document.getElementById("foto").value="";
      document.getElementById("status").value="Criado";
    }
  </script>
</body>
</html>
